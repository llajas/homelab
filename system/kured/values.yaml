kured:
  configuration:
    annotateNodes: true
    rebootSentinelCommand: sh -c "/usr/local/bin/rebooter.sh"
    period: 5m
    rebootDays: [mo, fr]
    startTime: 21:00
    endTime: 5:00
    timeZone: America/Chicago

  initContainers:
    - name: deploy-rebooter-script
      image: alpine:latest
      command: ["/bin/sh", "-c"]
      args:
        - >
          REBOOTER_SCRIPT_BASE64="IyEvYmluL2Jhc2gKTE9HX0ZJTEU9Ii92YXIvbG9nL3JlYm9vdGVyX2NoZWNrLmxvZyIKbG9nX21lc3NhZ2UoKSB7CiAgICBlY2hvICIkKFRaPSdBbWVyaWNhL0NoaWNhZ28nIGRhdGUgJyslWS0lbS0lZCAlSDolTTolUyAlWicpOiAkMSIgPj4gIiRMT0dfRklMRSIKfQppZiBbIC1mICIvdmFyL3J1bi9yZWJvb3QtcmVxdWlyZWQiIF07IHRoZW4KICAgIGxvZ19tZXNzYWdlICJSZWJvb3QgcmVxdWlyZWQgZHVlIHRvIC92YXIvcnVuL3JlYm9vdC1yZXF1aXJlZCBmaWxlLiIKICAgIGV4aXQgMApmaQppZiAhIG5lZWRzLXJlc3RhcnRpbmcgLS1yZWJvb3RoaW50OyB0aGVuCiAgICBsb2dfbWVzc2FnZSAiTm8gcmVib290IG5lZWRlZCBhY2NvcmRpbmcgdG8gbmVlZHMtcmVzdGFydGluZy4iCiAgICBleGl0IDAKZmkKbG9nX21lc"
          if [ ! -f /host/usr/local/bin/rebooter.sh ]; then
            echo "Deploying rebooter script..."
            echo "$REBOOTER_SCRIPT_BASE64" | base64 -d > /host/usr/local/bin/rebooter.sh
            chmod +x /host/usr/local/bin/rebooter.sh
          else
            echo "rebooter.sh script already exists. Skipping deployment."
          fi
      volumeMounts:
        - name: host-usr-local-bin
          mountPath: /host/usr/local/bin

  volumes:
    - name: host-usr-local-bin
      hostPath:
        path: /usr/local/bin
        type: DirectoryOrCreate
